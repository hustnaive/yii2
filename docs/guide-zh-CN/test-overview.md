测试
=======

测试是软件开发环境中很重要的一环。不管是否意识到，我们实际上是在不断的进行测试。比如:我们在PHP中写了一个class，我们会一步一步地debug或者简单的用`echo`或者`die`语句来验证这个class是否是按照我们期望的那样去运行的。同样，在web应用开发中，我们会在表单中输入一些测试数据来确保页面按照我们期望的方式去响应。

测试的过程可以自动化的进行，这样，每次我们需要验证某个时期的时候，我们只需要调用的"代码"来替我们完成。这些代替我们去验证结果是否符合预期的“代码”称之为“测试”，而编写并进一步执行测试代码的过程我们称之为“自动化测试”，自动化测试则是本文和随后的章节的主要内容。

开发中的测试
------------------

测试驱动开发方法（TDD）和行为驱动开发方法（BDD）是一种在开发实际的软件代码之前，首先写一系列的测试场景或者测试用例来描述代码的行为或者期望的功能，然后才会开始真正的去写实现代码并通过测试用例来验证实现代码是否按照期望的行为运行的方法。

基于测试驱动开发方法开发一个功能的过程如下：

- 创建一个新的测试来描述将要实现的功能点。
- 运行测试，确定他测试不通过。因为没有实现功能，所以这是期望的结果。
- 写一些简单的代码来让测试通过。
- 运行所有的测试，确认所有的测试都通过。
- 对代码进行改进，并确认所有的测试用例仍然正常运行。

在一个迭代完成后，进行下一个功能点或者改进点的开发就是重复上述过程。如果已经存在的特性要被修改，测试用例同样也应该被修改。

> **注意**：如果你觉得大量的简单小的迭代测试是浪费时间，你可以尝试让你的测试用例覆盖更多的场景，这样，你可以在再次执行测试之前完成更多的任务。相反，如果你需要不断测试，那么大量的小迭代是必须的。

在开始实现功能代码前就创建测试的目的是让我们集中精力了解我们想要实现的功能点是什么，并充分思考“如何去实现”。通常，这样会让我们的代码有更好的抽象、更松散的耦合、并当我们遇到需求变更时更容易维护。

总而言之，TDD或者BDD方法有如下优点：

- 让你一个时间集中精力在一件事情上，并改进计划和实现。
- 让详尽的测试覆盖更多的功能点。也就是，如果测试正常，那么基本上功能上也没什么问题。

从长远来看，这种方法更能提高你的效率。

> **注意**：如果你想知道更多关于如何聚焦软件需求、对主题进行建模，你可以参考[领域驱动开发(DDD)](https://en.wikipedia.org/wiki/Domain-driven_design)

何时&如何测试
------------------

上述的测试方法对于一些长期、相对复杂的项目非常有效，而对于一些简单的项目，则有些小题大做。当你的项目有以下的特征时，说明你需要引入测试了：

- 项目本身已经非常大并复杂了。
- 项目的依赖已经开始变得复杂。项目增长很快。
- 项目是一个长期的工作。
- 错误的代价太高。

为已有的实现代码创建测试用例来覆盖软件的运行行为也是需要的：

- 项目是历史遗留下来的，并在逐渐更新
- 你需要参与这个项目，它没有测试

在某些情况下，自动化测试可能有点小题大做：

- 项目很简单，并不会复杂化
- 它是一个一次性的项目，不会有后续迭代

当然，如果你有时间，即便在这些简单的项目中，最好也能够编写一些自动化测试用例。

进一步阅读
-------------

- Test Driven Development: By Example / Kent Beck. ISBN: 0321146530.
